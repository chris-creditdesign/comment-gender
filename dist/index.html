<style scoped>
.status-message{border:1px solid #c00;background:#fac7c7;padding:10px}.outer-wrapper{width:630px;height:920px;display:none}.outer-wrapper h1{font-size:1.1em;letter-spacing:.1em;padding:0 0 0 3px;margin:0}.outer-wrapper .count-chart{position:relative;height:350px;width:630px}.outer-wrapper .count-chart .tooltip{position:absolute;padding:10px;background-color:#333;pointer-events:none;opacity:0;z-index:100}.outer-wrapper .count-chart .tooltip p{margin:0;color:#ecf0f1;font-family:sans-serif;font-size:16px;line-height:20px}.outer-wrapper .count-chart .tooltip:before{content:"";position:absolute;bottom:-10px;left:49%;border-right:0;border-top:10px solid #333;border-bottom:0;border-left:10px solid transparent}.outer-wrapper .count-chart .tooltip.hidden{display:none}.outer-wrapper .count-chart .axis line,.outer-wrapper .count-chart .axis path{fill:none;stroke:#666;shape-rendering:crispEdges}.outer-wrapper .count-chart .axis text{font-family:sans-serif;fill:#666;font-size:13px;shape-rendering:crispEdges}.outer-wrapper .count-chart .x.axis text{font-size:12px;cursor:default}.outer-wrapper .count-chart rect{shape-rendering:crispEdges;-webkit-transition:fill 125ms linear;-moz-transition:fill 125ms linear;-ms-transition:fill 125ms linear;-o-transition:fill 125ms linear;transition:fill 125ms linear}.outer-wrapper .wrapper{width:630px;padding:0 0 0 10px;float:left;clear:left}.outer-wrapper .wrapper h2{text-transform:uppercase;font-size:1.1em;letter-spacing:.1em;text-align:center;color:#666;padding:10px 0 5px;margin:0 0 5px}.outer-wrapper .wrapper p{font-size:1.1em;line-height:1.4em;padding:10px 0 0;text-align:center;font-weight:400;color:#666}.outer-wrapper .wrapper form label{float:left;width:115px;margin:0 10px 6px 0;padding:0 0 0 30px;position:relative;-webkit-backface-visibility:hidden;display:block;cursor:pointer;-webkit-transition:color 250ms linear;-moz-transition:color 250ms linear;-ms-transition:color 250ms linear;-o-transition:color 250ms linear;transition:color 250ms linear}.outer-wrapper .wrapper form label:hover{color:#a0bec5}.outer-wrapper .wrapper form label input{outline:0!important;opacity:0;filter:alpha(opacity=0);zoom:1;float:left;margin-left:-40px}.outer-wrapper .wrapper form label span{display:block;height:20px;left:0;opacity:1;position:absolute;top:2px;width:20px;-webkit-backface-visibility:hidden}.outer-wrapper .wrapper form label.checkbox{fill:#ecf0f1}.outer-wrapper .wrapper form label.checkbox.checked .icon .dots{fill:#a0bec5;opacity:.8;-webkit-transition:fill 250ms linear;-moz-transition:fill 250ms linear;-ms-transition:fill 250ms linear;-o-transition:fill 250ms linear;transition:fill 250ms linear}.outer-wrapper .wrapper form label.checkbox.checked .icon .dots.Australasia{fill:#1abc9c}.outer-wrapper .wrapper form label.checkbox.checked .icon .dots.North_America{fill:#27ae60}.outer-wrapper .wrapper form label.checkbox.checked .icon .dots.Asia{fill:#3498db}.outer-wrapper .wrapper form label.checkbox.checked .icon .dots.Europe{fill:#5959b7}.outer-wrapper .wrapper form label.checkbox.checked .icon .dots.South_America{fill:#eb6b4b}.outer-wrapper .wrapper form.field-select label{width:170px}
</style>
<h1>Gender barchart for comment</h1>
<p>Introduction</p>

<p class="status-message"><em>The interactive companion to this table requires a modern browser (e.g. Chrome, Safari, Firefox or Internet Explorer 9+) with javascript enabled.</em></p>

<div class="outer-wrapper">
	
	<h1>Total papers published</h1>
	<div class="count-chart">
		<div class="tooltip hidden">
			<p><span class="value"></span></p>
		</div>
	</div><!-- count-chart -->

	<div class="wrapper">
	<h2>Field</h2>
		<form class="field-select">

			<label class="checkbox checked" for="TotalPaper">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots TotalPaper'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>	
				<input type="radio" name="mode" id="TotalPaper" value="TotalPaper" checked>
				<strong>Total papers published</strong>
			</label>
			<label class="checkbox" for="FMRatio">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots FMRatio'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>
				<input type="radio" name="mode" id="FMRatio" value="FMRatio">
				<strong>Female to Male Ratio</strong>
			</label>
			<label class="checkbox" for="Single">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots Single'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>	
				<input type="radio" name="mode" id="Single" value="Single">
				Single author
			</label>
			<label class="checkbox" for="NatFirst">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots NatFirst'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>	
				<input type="radio" name="mode" id="NatFirst" value="NatFirst">
				National first author
			</label>
			<label class="checkbox" for="NatLast">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots NatLast'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>	
				<input type="radio" name="mode" id="NatLast" value="NatLast">
				National last author
			</label>
			<label class="checkbox" for="IntFirst">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots IntFirst'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>	
				<input type="radio" name="mode" id="IntFirst" value="IntFirst">
				International first author
			</label>
			<label class="checkbox" for="IntLast">
				<span class='icon'>
					<svg height='20' width='20'>
						<circle cx='10' cy='10' r='10' class='dots IntLast'></circle>
						<polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon>
					</svg>
				</span>	
				<input type="radio" name="mode" id="IntLast" value="IntLast">
				International last author
			</label>
		</form>
	</div><!--class="field-wrapper"-->

	<div class="wrapper">
		<h2>Continent</h2>
		<form class="continent-select">
		</form>
	</div>

	<div class="wrapper">
		<h2>Country</h2>
		<form class="country-select">
		</form>
	</div><!--wrapper country-wrapper-->

</div> <!-- outer-wrapper -->
<!--[if gt IE 8]><!-->
<script src="http://www.nature.com/polopoly_static/js/d3.v3.min.js" charset="utf-8"></script>
<script type="text/javascript">
var allBars=["#1abc9c","#27ae60","#3498db","#5959b7","#EB6B4B"];!function(){var a=function(a){function b(){var b=".checkbox",c=b+" input[type='checkbox']",d=b+" input[type='radio']",e="checked";a(b).each(function(){a(this).removeClass(e)}),a(c+":checked").each(function(){a(this).parent(b).addClass(e)}),a(d+":checked").each(function(){a(this).parent(b).addClass(e)})}function c(a,b){return a.country<b.country?-1:a.country>b.country?1:0}a(".outer-wrapper").css({display:"block"}),a(".status-message").css({display:"none"});var d={top:15,right:20,bottom:20,left:75},e=630-d.left-d.right,f=350-d.top-d.bottom,g=450,h=[],i=[],j=[],k="TotalPaper",l="Total papers published",m="Papers published",n=[],o=[],p=["All"],q=[],r=!0,s=d3.select(".count-chart").append("svg").attr("width",e+d.left+d.right).attr("height",f+d.top+d.bottom),t=s.append("g").attr("transform","translate("+d.left+",0)"),u=s.append("g").attr("transform","translate("+d.left+",0)"),v=s.append("g").attr("class","x axis").attr("transform","translate("+d.left+",0)"),w=s.append("g").attr("class","axis").attr("transform","translate(-49,-5)").attr("opacity",0);w.append("rect").attr("x",e+d.left-50).attr("y",f+d.top+d.bottom-10).attr("width","10").attr("height","10").attr("opacity",.6).attr("fill","#34495e").attr("stroke","none"),w.append("text").attr("x",e+d.left-35).attr("y",f+d.top+d.bottom).style("text-anchor","right").text("Male"),w.append("rect").attr("x",e+d.left).attr("y",f+d.top+d.bottom-10).attr("width","10").attr("height","10").attr("fill","#34495e").attr("stroke","none"),w.append("text").attr("x",e+d.left+15).attr("y",f+d.top+d.bottom).style("text-anchor","left").text("Female");var x=d3.format(",");a.ajax({url:"https://poly-admin1.nature.com/preview/www/2.788/1.14321/7.14179",dataType:"text",success:function(y){function z(){for(;n.length>0;)n.shift();for(;j.length>0;)j.shift();for(;i.length>0;)i.shift();for(;i.length>0;)i.shift();for(var a=0;a<h.length;a++)j.push({});for(var c=0;c<j.length;c++)j[c].country=h[c].country,j[c].countryCode=h[c].countryCode,j[c].continent=h[c].continent;switch(k){case"TotalPaper":for(var d=0;d<j.length;d++)j[d].choice=h[d].TotalPaper,j[d].choiceFemale=0;break;case"Single":for(var e=0;e<j.length;e++)j[e].choice=h[e].SingleM,j[e].choiceFemale=h[e].SingleF;break;case"NatFirst":for(var f=0;f<j.length;f++)j[f].choice=h[f].NatFirstM,j[f].choiceFemale=h[f].NatFirstF;break;case"NatLast":for(var g=0;g<j.length;g++)j[g].choice=h[g].NatLastM,j[g].choiceFemale=h[g].NatLastF;break;case"IntFirst":for(var l=0;l<j.length;l++)j[l].choice=h[l].IntFirstM,j[l].choiceFemale=h[l].IntFirstF;break;case"IntLast":for(var m=0;m<j.length;m++)j[m].choice=h[m].IntLastM,j[m].choiceFemale=h[m].IntLastF;break;case"FMRatio":for(var o=0;o<j.length;o++)j[o].choice=h[o].FMRatio,j[o].choiceFemale=0;break;default:for(var p=0;p<j.length;p++)j[p].choice=h[p].TotalPaper,j[p].choiceFemale=0}for(var q=0;q<j.length;q++){var r=j[q].country;d3.select(".country-select [value="+r+"]").property("checked")&&n.push(j[q])}B(),E(),b()}function A(){var b=a(this).val();if("All"===b)a(".continent-select input").prop("checked",a(this).prop("checked")),a(".country-select input").prop("checked",a(this).prop("checked"));else for(var c=0;c<a(".country-select input").length;c++){var d=a(".country-select input").eq(c);b===d.data("continent")&&d.prop("checked",a(this).prop("checked"))}z()}function B(){J.domain([0,d3.max(n,function(a){return a.choice})]),n.length>5?L.domain(d3.range(n.length)):L.domain(d3.range(5));var a=t.selectAll("rect").data(n,function(a){return a.country}),b=u.selectAll("rect").data(n,function(a){return a.country});q.push(a[0].length),r=q.slice(-2)[1]>=q.slice(-2)[0]?!0:!1,q.shift(),a.enter().append("rect").attr("x",function(a,b){return L(b)}).attr("width",function(){return"TotalPaper"==k||"FMRatio"==k?L.rangeBand():L.rangeBand()/2}).attr("y",f+d.top).attr("height",0).attr("opacity",.6).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),b.enter().append("rect").attr("x",function(a,b){return L(b)+L.rangeBand()/2}).attr("width",L.rangeBand()/2).attr("y",f+d.top).attr("height",0).attr("opacity",1).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),a.transition().duration(g).delay(function(){return r?0:g}).attr("x",function(a,b){return L(b)}).attr("width",function(){return"TotalPaper"==k||"FMRatio"==k?L.rangeBand():L.rangeBand()/2}).attr("y",function(a){return d.top+J(a.choice)}).attr("height",function(a){return f-J(a.choice)}),b.transition().duration(g).delay(function(){return r?0:g}).attr("x",function(a,b){return L(b)+L.rangeBand()/2}).attr("width",L.rangeBand()/2).attr("y",function(a){return d.top+J(a.choiceFemale)}).attr("height",function(a){return f-J(a.choiceFemale)}),a.exit().transition().duration(g).attr("x",function(){return d3.select(this).attr("x")}).attr("width",function(){return d3.select(this).attr("width")}).attr("y",f+d.top).attr("height",0).remove(),b.exit().transition().duration(g).attr("x",function(){return d3.select(this).attr("x")}).attr("width",function(){return d3.select(this).attr("width")}).attr("y",f+d.top).attr("height",0).remove();var c=v.selectAll("text").data(n,function(a){return a.country});c.enter().append("text").attr("x",function(a,b){return L(b)+L.rangeBand()/2}).attr("y",function(){return f+d.top}).attr("text-anchor","middle").text(function(a){return a.countryCode}),c.transition().duration(g).delay(function(){return r?0:g}).attr("x",function(a,b){return L(b)+L.rangeBand()/2}).attr("y",function(a){return a.choiceFemale>=a.choice?d.top+J(a.choiceFemale)-4:d.top+J(a.choice)-4}),c.exit().transition().duration(g).attr("x",function(){return d3.select(this).attr("x")}).attr("y",f+d.top).remove(),s.select(".outer-wrapper .y").transition().duration(g).call(K),a.on("mouseover",function(c,d){var e,f=c.country,g=c.choice,h=c.choiceFemale,i=d3.select(this).attr("x");e=c.choiceFemale>=c.choice?d3.select(b[0][d]).attr("y"):d3.select(a[0][d]).attr("y"),d3.select(this).attr("fill","#f1c40f"),d3.select(b[0][d]).attr("fill","#f1c40f"),C(f,g,h,i,e)}).on("mouseout",function(a,c){d3.select(this).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),d3.select(b[0][c]).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),D()}),b.on("mouseover",function(c,d){var e,f=c.country,g=c.choice,h=c.choiceFemale,i=d3.select(a[0][d]).attr("x");e=c.choiceFemale>=c.choice?d3.select(b[0][d]).attr("y"):d3.select(a[0][d]).attr("y"),d3.select(a[0][d]).attr("fill","#f1c40f"),d3.select(this).attr("fill","#f1c40f"),C(f,g,h,i,e)}).on("mouseout",function(b,c){d3.select(a[0][c]).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),d3.select(this).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),D()}),c.on("mouseover",function(c,d){var e,f=c.country,g=c.choice,h=c.choiceFemale,i=d3.select(a[0][d]).attr("x");e=c.choiceFemale>=c.choice?d3.select(b[0][d]).attr("y"):d3.select(a[0][d]).attr("y"),d3.select(a[0][d]).attr("fill","#f1c40f"),d3.select(b[0][d]).attr("fill","#f1c40f"),C(f,g,h,i,e)}).on("mouseout",function(c,d){d3.select(a[0][d]).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),d3.select(b[0][d]).attr("fill",function(a){switch(a.continent){case"Australasia":return allBars[0];case"North_America":return allBars[1];case"Asia":return allBars[2];case"Europe":return allBars[3];case"South_America":return allBars[4];default:return allBars[0]}}),D()})}function C(b,c,d,e,f){var h,i="",j=b.replace(/_/g," ");h="TotalPaper"==k?x(c):c,i="TotalPaper"==k||"FMRatio"==k?j+"<br /> "+h:j+"<br />Male: "+c+"<br />Female: "+d,d3.select(".tooltip").select(".value").html(i);var l=parseInt(a(".tooltip").css("width"),10),m=parseInt(a(".tooltip").css("height"),10),n=parseInt(e,10)-l/2+65,o=parseInt(f,10)-m-43;d3.select(".tooltip").style("left",n+"px").style("top",o+"px"),d3.select(".tooltip").classed("hidden",!1).transition().duration(g/2).style("opacity",1)}function D(){d3.select(".tooltip").transition().duration(g/2).style("opacity",0).each("end",function(){d3.select(".tooltip").classed("hidden",!0)})}function E(a){switch(a){case"TotalPaper":l="Total papers published",m="Papers published",w.transition().duration(g).attr("opacity",0);break;case"Single":l="Single",m="Citations",w.transition().duration(g).attr("opacity",1);break;case"NatFirst":l="National first",m="Citations",w.transition().duration(g).attr("opacity",1);break;case"NatLast":l="National last",m="Citations",w.transition().duration(g).attr("opacity",1);break;case"IntFirst":l="International first",m="Citations",w.transition().duration(g).attr("opacity",1);break;case"IntLast":l="International last",m="Citations",w.transition().duration(g).attr("opacity",1);break;case"FMRatio":l="Female to male ratio",m="Female to male ratio",w.transition().duration(g).attr("opacity",0)}d3.select(".outer-wrapper h1").text(l),d3.selectAll(".y .axisLabel text").text(m)}for(var F=a(y).find("tbody tr"),G=0;G<F.length;G++){var H={};H.country=F.eq(G).find("td").eq(0).text(),H.countryCode=F.eq(G).find("td").eq(1).text(),H.continent=F.eq(G).find("td").eq(2).text(),H.TotalPaper=parseInt(F.eq(G).find("td").eq(3).text(),10),H.SingleF=parseFloat(F.eq(G).find("td").eq(4).text()),H.SingleM=parseFloat(F.eq(G).find("td").eq(5).text()),H.NatFirstF=parseFloat(F.eq(G).find("td").eq(6).text()),H.NatFirstM=parseFloat(F.eq(G).find("td").eq(7).text()),H.NatLastF=parseFloat(F.eq(G).find("td").eq(8).text()),H.NatLastM=parseFloat(F.eq(G).find("td").eq(9).text()),H.IntFirstF=parseFloat(F.eq(G).find("td").eq(10).text()),H.IntFirstM=parseFloat(F.eq(G).find("td").eq(11).text()),H.IntLastF=parseFloat(F.eq(G).find("td").eq(12).text()),H.IntLastM=parseFloat(F.eq(G).find("td").eq(13).text()),H.FMRatio=parseFloat(F.eq(G).find("td").eq(14).text()),h.push(H)}var I=h.length;q.push(I),o=h.map(function(a){return a.continent}),a.each(o,function(b,c){-1===a.inArray(c,p)&&p.push(c)}),d3.selectAll(".continent-select").selectAll("label").data(p.sort()).enter().append("label").attr("class","checkbox").html(function(a){var b=a.replace(/_/g," ");return"<span class='icon'>	<svg height='20' width='20'><circle cx='10' cy='10' r='10' class='dots "+a+"'></circle><polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon></svg></span><input type='checkbox' value='"+a+"' data-continent='"+a+"' checked>"+b}),d3.selectAll(".country-select").selectAll("label").data(h.sort(c)).enter().append("label").attr("class","checkbox").html(function(a){var b=a.country.replace(/_/g," ");return"<span class='icon'>	<svg height='20' width='20'><circle cx='10' cy='10' r='10' class='dots'></circle><polygon fill='#ECF0F1' points='8.163,11.837 6.062,9.737 3.963,11.837 6.062,13.938 8.163,16.037 16.037,8.162 13.938,6.062'/></polygon></svg></span><input type='checkbox' value='"+a.country+"' data-continent='"+a.continent+"' checked>"+b+" ("+a.countryCode+")"}),d3.selectAll(".field-select input").on("change",function(){k=this.value,z(),E(k)}),d3.selectAll(".country-select input").on("change",z),d3.selectAll(".continent-select input").on("change",A);var J=d3.scale.linear().range([f,0]),K=d3.svg.axis().scale(J).tickSize(3,3).orient("left");s.append("g").attr("class","y axis").attr("transform","translate("+d.left+","+d.top+")").append("g").attr("class","axisLabel").append("text").attr("transform","rotate(-90)").attr("y",-d.left).attr("x",-f).attr("dy",".9em").style("text-anchor","left");var L=d3.scale.ordinal().domain(d3.range(h.length)).rangeRoundBands([0,e+d.right],.4);z(),b()}})};setTimeout(function(){"undefined"!=typeof jQuery?a(jQuery):setTimeout(arguments.callee,60)},60)}();
</script>
<!--<![endif]-->